generator client {
  provider      = "prisma-client-js"
  output        = "../app/generated/prisma"
  binaryTargets = ["native", "debian-openssl-3.0.x"]
}

datasource db {
  provider = "sqlserver"
  url      = env("DATABASE_URL")
}

model sysdiagrams {
  name         String @db.NVarChar(128)
  principal_id Int
  diagram_id   Int    @id(map: "PK__sysdiagr__C2B05B6133002054") @default(autoincrement())
  version      Int?
  definition   Bytes?

  @@unique([principal_id, name], map: "UK_principal_name")
}

model Tbl_Greenhouses {
  ID                   Int                    @id(map: "PK_Tbl_Greenhouses") @default(autoincrement())
  OwnerID              Int?
  GreenhouseName       String?                @db.NVarChar(150)
  GreenhouseType       String?                @db.NVarChar(150)
  AreaSqM              Decimal?               @db.Decimal(10, 2)
  ConstructionDate     DateTime?              @db.Date
  GreenhouseAddress    String?                @db.NVarChar(250)
  IsActive             Boolean?
  Notes                String?                @db.NVarChar(500)
  Tbl_People           Tbl_People?            @relation(fields: [OwnerID], references: [ID], onDelete: NoAction, onUpdate: NoAction, map: "FK_Tbl_Greenhouses_Tbl_People")
  Tbl_SeedlingPlanting Tbl_SeedlingPlanting[]
  Tbl_SeedPlanting     Tbl_SeedPlanting[]
}

model Tbl_NurseryRoom {
  ID                   Int                @id(map: "PK_Tbl_NurseryRoom") @default(autoincrement())
  NurseryRoomCode      String?            @db.NVarChar(50)
  NurseryRoomName      String?            @db.NVarChar(100)
  TemperatureMin       Decimal?           @db.Decimal(5, 2)
  TemperatureMax       Decimal?           @db.Decimal(5, 2)
  HumidityMin          Decimal?           @db.Decimal(5, 2)
  HumidityMax          Decimal?           @db.Decimal(5, 2)
  LightType            String?            @db.NVarChar(50)
  LightHoursPerDay     Decimal?           @db.Decimal(4, 1)
  CO2Range             String?            @db.NVarChar(50)
  StrelizationMethod   String?            @db.NVarChar(200)
  NurseryRoomCreatedAt DateTime?          @db.Date
  Tbl_SeedPlanting     Tbl_SeedPlanting[]
}

model Tbl_People {
  ID              Int               @id(map: "PK_Tbl_People") @default(autoincrement())
  FirstName       String?           @db.NVarChar(150)
  LastName        String?           @db.NVarChar(150)
  PhoneNumber     String?           @db.NVarChar(150)
  EmailAddress    String?           @db.NVarChar(50)
  Profesion       String?           @db.NVarChar(150)
  Tbl_Greenhouses Tbl_Greenhouses[]
}

model Tbl_PlantGrowthStage {
  ID               Int               @id(map: "PK_Tbl_PlantGrowthStage") @default(autoincrement())
  VarietyID        Int?
  StageOrder       Int?
  StageName        String?           @db.NVarChar(100)
  EntryCriteria    String?           @db.NVarChar(100)
  StartDay         Int?
  ExitCriteria     String?           @db.NVarChar(100)
  EndDay           Int?
  note             String?           @db.NVarChar(500)
  Tbl_plantVariety Tbl_plantVariety? @relation(fields: [VarietyID], references: [ID], onDelete: NoAction, onUpdate: NoAction, map: "FK_Tbl_PlantGrowthStage_Tbl_plantVariety")
}

model Tbl_Plants {
  ID               Int                @id(map: "PK_Tbl_Plants") @default(autoincrement())
  CommonName       String?            @db.NVarChar(150)
  ScientificName   String?            @db.NVarChar(250)
  PlantFamily      String?            @db.NVarChar(150)
  Notes            String?            @db.NVarChar(500)
  Tbl_plantVariety Tbl_plantVariety[]
}

model Tbl_plantVariety {
  ID                   Int                    @id(map: "PK_Tbl_plantVariety") @default(autoincrement())
  PlantID              Int?
  VarietyName          String?                @db.NVarChar(200)
  DaysToGermination    Int?
  DaysToSprout         Int?
  DaysToSeedling       Int?
  DaysToMaturity       Int?
  IdealTempMin         Decimal?               @db.Decimal(6, 2)
  IdealTempMax         Decimal?               @db.Decimal(6, 2)
  IdealHumidityMin     Decimal?               @db.Decimal(6, 2)
  IdealHumidityMax     Decimal?               @db.Decimal(6, 2)
  LightRequirement     String?                @db.NVarChar(100)
  Notes                String?                @db.NVarChar(500)
  Tbl_PlantGrowthStage Tbl_PlantGrowthStage[]
  Tbl_Plants           Tbl_Plants?            @relation(fields: [PlantID], references: [ID], onDelete: NoAction, onUpdate: NoAction, map: "FK_Tbl_plantVariety_Tbl_Plants")
  Tbl_SeedlingPlanting Tbl_SeedlingPlanting[]
}

model Tbl_SeedlingPlanting {
  ID                  BigInt            @id(map: "PK_Tbl_SeedlingPlanting") @default(autoincrement())
  GreenhouseID        Int?
  VarietyID           Int?
  SupplierID          Int?
  PlantDate           DateTime?         @db.Date
  NumPlants           Int?
  PlantsPerM2         Decimal?          @db.Decimal(9, 3)
  ExpectedHarvestDate DateTime?         @db.Date
  ActualHarvestDate   DateTime?         @db.Date
  SeedingMethod       String?           @db.NVarChar(100)
  Notes               String?           @db.NVarChar(500)
  Tbl_Greenhouses     Tbl_Greenhouses?  @relation(fields: [GreenhouseID], references: [ID], onDelete: NoAction, onUpdate: NoAction, map: "FK_Tbl_SeedlingPlanting_Tbl_Greenhouses")
  Tbl_plantVariety    Tbl_plantVariety? @relation(fields: [VarietyID], references: [ID], onDelete: NoAction, onUpdate: NoAction, map: "FK_Tbl_SeedlingPlanting_Tbl_plantVariety")
  Tbl_suppliers       Tbl_suppliers?    @relation(fields: [SupplierID], references: [ID], onDelete: NoAction, onUpdate: NoAction, map: "FK_Tbl_SeedlingPlanting_Tbl_suppliers")
}

model Tbl_SeedPackage {
  ID                        Int                         @id(map: "PK_Tbl_SeedPackage") @default(autoincrement())
  ProducerID                Int?
  CropVariety               Int?
  GerminationRate           Int?
  PurityPercent             Int?
  ProductionDate            DateTime?                   @db.Date
  ExpirationDate            DateTime?                   @db.Date
  QualityGrade              String?                     @db.NVarChar(50)
  SerialNumber              String?                     @db.NVarChar(50)
  PackageType               String?                     @db.NVarChar(50)
  SeedCount                 Int?
  WeightGram                Decimal?                    @db.Decimal(8, 2)
  PackagingDate             DateTime?                   @db.Date
  PackagingLine             String?                     @db.NVarChar(50)
  QRCode                    Bytes?
  IsCertified               Boolean?
  Tbl_suppliers             Tbl_suppliers?              @relation(fields: [ProducerID], references: [ID], onDelete: NoAction, onUpdate: NoAction, map: "FK_Tbl_SeedPackage_Tbl_suppliers")
  Tbl_SeedPlanting          Tbl_SeedPlanting[]
  Tbl_WarehousesTransaction Tbl_WarehousesTransaction[]
}

model Tbl_SeedPlanting {
  ID                   Int              @id(map: "PK_Tbl_SeedPlanting") @default(autoincrement())
  SeedPackageID        Int?
  GreenhouseID         Int?
  NurseryRoomID        Int?
  PlantingDate         DateTime?        @db.Date
  EmergenceDate        DateTime?        @db.Date
  CurrentStage         String?          @db.NVarChar(50)
  HealthStatus         String?          @db.NVarChar(50)
  GrowthRate           Decimal?         @db.Decimal(5, 2)
  DiseaseObserved      String?          @db.NVarChar(200)
  ReadyForGraftingDate DateTime?        @db.Date
  Tbl_Greenhouses      Tbl_Greenhouses? @relation(fields: [GreenhouseID], references: [ID], onDelete: NoAction, onUpdate: NoAction, map: "FK_Tbl_SeedPlanting_Tbl_Greenhouses")
  Tbl_NurseryRoom      Tbl_NurseryRoom? @relation(fields: [NurseryRoomID], references: [ID], onDelete: NoAction, onUpdate: NoAction, map: "FK_Tbl_SeedPlanting_Tbl_NurseryRoom")
  Tbl_SeedPackage      Tbl_SeedPackage? @relation(fields: [SeedPackageID], references: [ID], onDelete: NoAction, onUpdate: NoAction, map: "FK_Tbl_SeedPlanting_Tbl_SeedPackage")
}

model Tbl_suppliers {
  ID                   Int                    @id(map: "PK_Tbl_suppliers") @default(autoincrement())
  Legal                Boolean?
  CompanyName          String?                @db.NVarChar(150)
  BrandName            String?                @db.NVarChar(150)
  SupplierCountry      String?                @db.NVarChar(150)
  SupplierCity         String?                @db.NVarChar(150)
  FirstName            String?                @db.NVarChar(150)
  LastName             String?                @db.NVarChar(150)
  ContactEmail         String?                @db.NVarChar(150)
  ContactTel           String?                @db.NVarChar(50)
  CompanyAddress       String?                @db.NVarChar(Max)
  LicenseNumber        String?                @db.NVarChar(50)
  Tbl_SeedlingPlanting Tbl_SeedlingPlanting[]
  Tbl_SeedPackage      Tbl_SeedPackage[]
}

model Tbl_Warehouses {
  ID                        Int                         @id(map: "PK_Tbl_Warehouses") @default(autoincrement())
  WarehouseCode             String?                     @db.NVarChar(50)
  WarehouseName             String?                     @db.NVarChar(150)
  WarehouseLocation         String?                     @db.NVarChar(200)
  TemperatureRange          String?                     @db.NVarChar(50)
  HumidityRange             String?                     @db.NVarChar(50)
  Capacity                  Int?
  WarehouseManagerName      String?                     @db.NVarChar(150)
  WarehouseCreatedAt        DateTime?                   @db.Date
  Tbl_WarehousesTransaction Tbl_WarehousesTransaction[]
}

model Tbl_WarehousesTransaction {
  ID              Int              @id(map: "PK_Tbl_WarehousesTransaction") @default(autoincrement())
  SeedPackageID   Int?
  WarehouseID     Int?
  TransactionType Boolean?
  PackageQuantity Int?
  TransactionDate DateTime?        @db.DateTime
  DestinationType String?          @db.NVarChar(50)
  RecordedBy      String?          @db.NVarChar(150)
  Tbl_SeedPackage Tbl_SeedPackage? @relation(fields: [SeedPackageID], references: [ID], onDelete: NoAction, onUpdate: NoAction, map: "FK_Tbl_WarehousesTransaction_Tbl_SeedPackage")
  Tbl_Warehouses  Tbl_Warehouses?  @relation(fields: [WarehouseID], references: [ID], onDelete: NoAction, onUpdate: NoAction, map: "FK_Tbl_WarehousesTransaction_Tbl_Warehouses")
}

model Users {
  ID           Int       @id @default(autoincrement())
  Username     String    @unique @db.NVarChar(150)
  PasswordHash String    @db.NVarChar(Max)
  CreatedAt    DateTime? @default(now())
  Email        String?   @db.NVarChar(150)
  IsActive     Boolean?  @default(true)
  RoleID       Int?      @default(1)
  Session      Session[]
}

model Session {
  ID         Int      @id @default(autoincrement())
  PublicID   String   @unique @db.NVarChar(150)
  SecretHash String   @db.NVarChar(Max)
  UserId     Int
  CreatedAt  DateTime @default(now())
  ExpiresAt  DateTime
  User       Users    @relation(fields: [UserId], references: [ID], onDelete: Cascade)
}
